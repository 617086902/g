
@{
    Layout = null;
}
<link href="~/Content/uploadImg/css/style.css" rel="stylesheet" type="text/css">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="format-detection" content="telephone=no, email=no" />
<script src="~/Scripts/jquery-1.10.2.min.js" type="text/javascript"></script>
<div>
    <a id="logox">
        <img style="width:100px;height:100px;" class="img-thumbnail" id="profilePhoto" src="~/Content/img/niu.png">
    </a>
</div>

<div class="htmleaf-container">
    <div id="clipArea"></div>
    <div class="foot-use">
        <div class="uploader1 blue">
            <input type="button" name="file" class="button" value="打开">
            <input id="file" type="file" onchange="javascript:setImagePreview();" accept="image/*" multiple />
        </div>
        <button id="clipBtn">提交</button>
    </div>
    <div id="view"></div>
</div>
<script src="~/Content/uploadImg/js/iscroll-zoom.js"></script>
<script src="~/Content/uploadImg/js/hammer.js"></script>
<script src="~/Content/uploadImg/js/jquery.photoClip.js"></script>
<script>
    var obUrl = ''
    //document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
    $("#clipArea").photoClip({
        width: 200,
        height: 200,
        file: "#file",
        view: "#view",
        ok: "#clipBtn",
        loadStart: function () {
            console.log("照片读取中");
        },
        loadComplete: function (data) {
            console.log("照片读取完成");
            console.log(data);
        },
        clipFinish: function (dataURL) {
            console.log(dataURL);
            $.ajax({
                url: "/common/UploadImg",
                method: "post",
                data: { imgdata: dataURL },
                dataType: "json",
                success: function (data) {
                    window.location.href = "/user/index";
                }
            });
        }
    });
</script>
<script>
    $(function () {
        $("#logox").click(function () {
            $(".htmleaf-container").show();
        })
        $("#clipBtn").click(function () {
            //$("#logox").empty();
            //$("#profilePhoto").attr("src",imgsource);
            //$('#logox').append('<img src="' + imgsource + '" align="absmiddle" style=" width: 5rem;height: 4.16rem; margin-left: 1.5rem;margin-top: 1.92rem">');
            //$(".htmleaf-container").hide();
        })
    });
</script>
<script type="text/javascript">
    $(function () {
        jQuery.divselect = function (divselectid, inputselectid) {
            var inputselect = $(inputselectid);
            $(divselectid + " small").click(function () {
                $("#divselect ul").toggle();
                $(".mask").show();
            });
            $(divselectid + " ul li a").click(function () {
                var txt = $(this).text();
                $(divselectid + " small").html(txt);
                var value = $(this).attr("selectid");
                inputselect.val(value);
                $(divselectid + " ul").hide();
                $(".mask").hide();
                $("#divselect small").css("color", "#333")
            });
        };
        $.divselect("#divselect", "#inputselect");
    });
</script>
<script type="text/javascript">
    $(function () {
        jQuery.divselectx = function (divselectxid, inputselectxid) {
            var inputselectx = $(inputselectxid);
            $(divselectxid + " small").click(function () {
                $("#divselectx ul").toggle();
                $(".mask").show();
            });
            $(divselectxid + " ul li a").click(function () {
                var txt = $(this).text();
                $(divselectxid + " small").html(txt);
                var value = $(this).attr("selectidx");
                inputselectx.val(value);
                $(divselectxid + " ul").hide();
                $(".mask").hide();
                $("#divselectx small").css("color", "#333")
            });
        };
        $.divselectx("#divselectx", "#inputselectx");
    });
</script>
<script type="text/javascript">
    $(function () {
        jQuery.divselecty = function (divselectyid, inputselectyid) {
            var inputselecty = $(inputselectyid);
            $(divselectyid + " small").click(function () {
                $("#divselecty ul").toggle();
                $(".mask").show();
            });
            $(divselectyid + " ul li a").click(function () {
                var txt = $(this).text();
                $(divselectyid + " small").html(txt);
                var value = $(this).attr("selectyid");
                inputselecty.val(value);
                $(divselectyid + " ul").hide();
                $(".mask").hide();
                $("#divselecty small").css("color", "#333")
            });
        };
        $.divselecty("#divselecty", "#inputselecty");
    });
</script>
<script type="text/javascript">
    $(function () {
        $(".mask").click(function () {
            $(".mask").hide();
            $(".all").hide();
        })
        $(".right input").blur(function () {
            if ($.trim($(this).val()) == '') {
                $(this).addClass("place").html();
            }
            else {
                $(this).removeClass("place");
            }
        })
    });
</script>

<script type="text/javascript">
    function setImagePreview() {
        var preview, img_txt, localImag, file_head = document.getElementById("file_head"),
                picture = file_head.value;
        if (!picture.match(/.jpg|.gif|.png|.bmp/i)) return alert("您上传的图片格式不正确，请重新选择！"),
                !1;
        if (preview = document.getElementById("preview"), file_head.files && file_head.files[0]) preview.style.display = "block",
                preview.style.width = "63px",
                preview.style.height = "63px",
                preview.src = window.navigator.userAgent.indexOf("Chrome") >= 1 || window.navigator.userAgent.indexOf("Safari") >= 1 ? window.webkitURL.createObjectURL(file_head.files[0]) : window.URL.createObjectURL(file_head.files[0]);
        else {
            file_head.select(),
                    file_head.blur(),
                    img_txt = document.selection.createRange().text,
                    localImag = document.getElementById("localImag"),
                    localImag.style.width = "63px",
                    localImag.style.height = "63px";
            try {
                localImag.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)",
                        localImag.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = img_txt
            } catch (f) {
                return alert("您上传的图片格式不正确，请重新选择！"),
                        !1
            }
            preview.style.display = "none",
                    document.selection.empty()
        }
        return document.getElementById("DivUp").style.display = "block",
                !0
    }
</script>
